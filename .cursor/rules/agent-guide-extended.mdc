---
alwaysApply: false
description: ××“×¨×™×š ×”×¢×•×–×¨ ×”××•×¨×—×‘ - ×¤×¨×˜×™× ×˜×›× ×™×™×, ×“×•×’×××•×ª ×•××™×“×¢ ××¢××™×§
---

# ğŸ“˜ ××“×¨×™×š ×”×¢×•×–×¨ ×”××•×¨×—×‘ - ×¡×“×¨ ×™×•× ×•×™×–×•××œ×™

> **×’×¨×¡×” ××•×¨×—×‘×ª** - ×§×¨× ××ª [agent-guide.mdc](agent-guide.mdc) ×ª×—×™×œ×”!

××¡××š ×–×” ××›×™×œ ×¤×¨×˜×™× ×˜×›× ×™×™× ××¢××™×§×™×, ×“×•×’×××•×ª ×§×•×“ ××œ××•×ª, ×•×”×¡×‘×¨×™× ××¤×•×¨×˜×™×.

---

## ğŸ“‘ ×ª×•×›×Ÿ ×¢× ×™×™× ×™×

1. [××‘× ×” ×ª×™×§×™×•×ª ××¤×•×¨×˜](#××‘× ×”-×ª×™×§×™×•×ª-××¤×•×¨×˜)
2. [×™×©×•×™×•×ª ××¨×›×–×™×•×ª - ×”×¨×—×‘×”](#×™×©×•×™×•×ª-××¨×›×–×™×•×ª---×”×¨×—×‘×”)
3. [×× ×’× ×•× ×™× ××™×•×—×“×™× - ×¤×¨×˜×™× ×˜×›× ×™×™×](#×× ×’× ×•× ×™×-××™×•×—×“×™×---×¤×¨×˜×™×-×˜×›× ×™×™×)
4. [××¢×¨×›×ª ×—×™×ª×•×š ×ª××•× ×•×ª - ××“×¨×™×š ××œ×](#××¢×¨×›×ª-×—×™×ª×•×š-×ª××•× ×•×ª---××“×¨×™×š-××œ×)
5. [××¢×¨×›×ª ××•×“×™×• - ××“×¨×™×š ××œ×](#××¢×¨×›×ª-××•×“×™×•---××“×¨×™×š-××œ×)
6. [××™×’×¨×¦×™×•×ª - ××“×¨×™×š ××œ×](#××™×’×¨×¦×™×•×ª---××“×¨×™×š-××œ×)
7. [×“×•×’×××•×ª ×§×•×“ ××œ××•×ª](#×“×•×’×××•×ª-×§×•×“-××œ××•×ª)
8. [×˜×¢×•×™×•×ª × ×¤×•×¦×•×ª - ×”×¨×—×‘×”](#×˜×¢×•×™×•×ª-× ×¤×•×¦×•×ª---×”×¨×—×‘×”)
9. [FAQ - ×©××œ×•×ª ×•×ª×©×•×‘×•×ª](#faq---×©××œ×•×ª-×•×ª×©×•×‘×•×ª)
10. [×”×§×©×¨ ×¤×“×’×•×’×™ ×•××©×¤×—×ª×™ ××œ×](#×”×§×©×¨-×¤×“×’×•×’×™-×•××©×¤×—×ª×™-××œ×)

---

## ğŸ—‚ï¸ ××‘× ×” ×ª×™×§×™×•×ª ××¤×•×¨×˜

```
sveltekit-version/src/lib/
â”œâ”€â”€ actions/
â”‚   â””â”€â”€ dbImage.ts
â”‚       # Action ×œ×˜×¢×™× ×ª ×ª××•× ×•×ª ×-IndexedDB
â”‚       # âš ï¸ ×œ× ×œ×©×™××•×© ×™×©×™×¨! ×¨×§ ×“×¨×š ImageDisplay
â”‚
â”œâ”€â”€ assets/
â”‚   â”œâ”€â”€ favicon.svg
â”‚   â””â”€â”€ logo.svg
â”‚       # ×œ×•×’×• "×¡×“×¨ ×™×•× ××•×‘× ×”"
â”‚
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ AddModal.svelte
â”‚   â”‚   # ××•×“××œ ×”×•×¡×¤×”/×¢×¨×™×›×ª ××©×™××”
â”‚   â”‚   # Controller: ××©×ª××© ×‘-listStore ×™×©×™×¨×•×ª
â”‚   â”‚
â”‚   â”œâ”€â”€ CelebrationModal.svelte
â”‚   â”‚   # ××•×“××œ ×—×’×™×’×” ×¢× confetti
â”‚   â”‚   # Props: show, onClose, celebrationData
â”‚   â”‚
â”‚   â”œâ”€â”€ FloatingIframe.svelte
â”‚   â”‚   # ×—×œ×•×Ÿ ×¦×£ ×œ×œ×•×— ×ª×§×©×•×¨×ª (Draggable, Resizable)
â”‚   â”‚   # ×©××™×¨×ª ××¦×‘: floatingBoardState.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ GoogleDriveBackup.svelte
â”‚   â”‚   # ×××©×§ ×’×™×‘×•×™ Google Drive
â”‚   â”‚   # Controller: BackupController
â”‚   â”‚
â”‚   â”œâ”€â”€ ImageCropEditor.svelte
â”‚   â”‚   # ×¢×•×¨×š ×—×™×ª×•×š ×ª××•× ×•×ª ××™× ×˜×¨××§×˜×™×‘×™
â”‚   â”‚   # Props: imageSrc, imageId, onSave
â”‚   â”‚   # Scale ×™×—×¡×™!
â”‚   â”‚
â”‚   â”œâ”€â”€ ImageDisplay.svelte
â”‚   â”‚   # â­ ×ª×¦×•×’×ª ×ª××•× ×•×ª ××—×™×“×” (×›×œ ×ª××•× ×” ×—×™×™×‘×ª ×“×¨×›×•!)
â”‚   â”‚   # Props: imageSrc, alt, extraClasses, lazyLoad
â”‚   â”‚   # ×˜×™×¤×•×œ: IndexedDB, Crop, Fallback
â”‚   â”‚
â”‚   â”œâ”€â”€ ImageUploader.svelte
â”‚   â”‚   # ×”×¢×œ××ª ×ª××•× ×•×ª + crop
â”‚   â”‚   # Props: currentImageSrc, onImageSelected
â”‚   â”‚
â”‚   â”œâ”€â”€ ListSwitcher.svelte
â”‚   â”‚   # ×”×—×œ×¤×ª ×¨×©×™××•×ª
â”‚   â”‚   # Controller: ListsNavigationController
â”‚   â”‚
â”‚   â”œâ”€â”€ SplashScreen.svelte
â”‚   â”‚   # ××¡×š ×˜×¢×™× ×” (5 ×©× ×™×•×ª)
â”‚   â”‚   # Props: onFinish
â”‚   â”‚
â”‚   â”œâ”€â”€ TaskRow.svelte
â”‚   â”‚   # ×©×•×¨×ª ××©×™××” (×›×¨×˜×™×¡×™×™×”)
â”‚   â”‚   # Props: task, isActive, onToggle
â”‚   â”‚   # ×¢×™×¦×•×‘ ××™×•×—×“ ×œ××©×™××•×ª "×‘×•×˜×œ×”"
â”‚   â”‚
â”‚   â””â”€â”€ UserSelector.svelte
â”‚       # ×‘×—×™×¨×ª ××©×ª××© (×“×£ ×”×ª×—×‘×¨×•×ª)
â”‚       # Controller: userStore
â”‚
â”œâ”€â”€ config.ts
â”‚   # ×§×•× ×¤×™×’×•×¨×¦×™×”: GOOGLE_CLIENT_ID, SCOPES
â”‚
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ boosts.ts
â”‚   â”‚   # ×‘× ×§ ×—×™×–×•×§×™× (× ×ª×•× ×™× ×‘×œ×‘×“)
â”‚   â”‚   # BOOSTS_BOY, BOOSTS_GIRL, BOOSTS_FILES
â”‚   â”‚
â”‚   â”œâ”€â”€ defaults.ts
â”‚   â”‚   # â­ SINGLE SOURCE OF TRUTH ×œ× ×ª×•× ×™× ×¡×˜×˜×™×™×
â”‚   â”‚   # ACTIVITIES, DEFAULT_LIST_DEFINITIONS, INITIAL_STATE
â”‚   â”‚
â”‚   â””â”€â”€ texts.ts
â”‚       # â­ SINGLE SOURCE OF TRUTH ×œ×˜×§×¡×˜×™×
â”‚       # TEXTS - ×›×œ ×”×˜×§×¡×˜×™× ×‘××¢×¨×›×ª
â”‚
â”œâ”€â”€ logic/
â”‚   â”œâ”€â”€ backupController.svelte.ts
â”‚   â”‚   # Controller: ×œ×•×’×™×§×ª ×’×™×‘×•×™ ××•×˜×•××˜×™
â”‚   â”‚   # Debounce 5 ×©× ×™×•×ª, ×˜×¨×™×’×¨ ×-globalState
â”‚   â”‚
â”‚   â”œâ”€â”€ dragDrop.svelte.ts
â”‚   â”‚   # Controller: × ×™×”×•×œ Drag & Drop
â”‚   â”‚   # HTML5 Drag API + reordering
â”‚   â”‚
â”‚   â”œâ”€â”€ listsNavigation.svelte.ts
â”‚   â”‚   # Controller: × ×™×”×•×œ ×¨×©×™××•×ª
â”‚   â”‚   # getCurrentList(), switchList(), getVisibleLists()
â”‚   â”‚
â”‚   â”œâ”€â”€ session.svelte.ts
â”‚   â”‚   # Controller: × ×™×”×•×œ ×¡×©×Ÿ (×–××Ÿ ××—×¨×•×Ÿ)
â”‚   â”‚   # ×¢×“×›×•×Ÿ lastActiveTime
â”‚   â”‚
â”‚   â””â”€â”€ tasksBoard.svelte.ts
â”‚       # â­ Controller ××¨×›×–×™ (××©×™××•×ª + ×—×’×™×’×•×ª)
â”‚       # toggleTask(), handleTaskClick(), openCommunicationBoard()
â”‚
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ audio.ts
â”‚   â”‚   # × ×™×’×•×Ÿ ×§×‘×¦×™ ××•×“×™×• ×‘×¡×™×¡×™
â”‚   â”‚   # play(url): Promise<void>
â”‚   â”‚
â”‚   â”œâ”€â”€ audioSequencer.ts
â”‚   â”‚   # ×¨×¦×¤×™ ××•×“×™×• (MP3 + TTS)
â”‚   â”‚   # playSequence(segments: AudioSegment[]): Promise<void>
â”‚   â”‚
â”‚   â”œâ”€â”€ boosts.ts
â”‚   â”‚   # â­ ×©×™×¨×•×ª ×—×™×–×•×§×™× ×¨× ×“×•××œ×™×™×
â”‚   â”‚   # getRandomBoost(gender), getFeedbackSequence()
â”‚   â”‚
â”‚   â”œâ”€â”€ db.ts
â”‚   â”‚   # IndexedDB wrapper
â”‚   â”‚   # saveImage(blob), getImage(id), deleteImage(id)
â”‚   â”‚
â”‚   â”œâ”€â”€ floatingBoardState.ts
â”‚   â”‚   # ×©××™×¨×ª ××¦×‘ ×œ×•×— ×ª×§×©×•×¨×ª ×¦×£
â”‚   â”‚   # localStorage × ×¤×¨×“ (×œ× ×—×œ×§ ×-AppState)
â”‚   â”‚
â”‚   â”œâ”€â”€ googleDriveService.ts
â”‚   â”‚   # Google Drive API
â”‚   â”‚   # authenticate(), upload(), download()
â”‚   â”‚
â”‚   â”œâ”€â”€ language.ts
â”‚   â”‚   # â­ SINGLE SOURCE OF TRUTH ×œ×˜×§×¡×˜×™×
â”‚   â”‚   # TEXTS, LanguageService
â”‚   â”‚
â”‚   â””â”€â”€ migration.ts
â”‚       # â­ ××™×’×¨×¦×™×•×ª ×’×¨×¡××•×ª
â”‚       # migrateToLatest(state): AppState
â”‚
â””â”€â”€ stores/
    â”œâ”€â”€ globalState.svelte.ts
    â”‚   # â­ State ××¨×›×–×™ (AppState)
    â”‚   # Persistence, Migration, Auto-backup trigger
    â”‚
    â”œâ”€â”€ imageStore.svelte.ts
    â”‚   # × ×™×”×•×œ metadata ×©×œ ×ª××•× ×•×ª
    â”‚   # getImageMetadata(id), setImageCrop(id, crop)
    â”‚
    â”œâ”€â”€ listStore.svelte.ts
    â”‚   # × ×™×”×•×œ ×¨×©×™××•×ª (CRUD)
    â”‚   # getLists(), addTask(), updateTask(), deleteTask()
    â”‚
    â”œâ”€â”€ persistence.ts
    â”‚   # ×©××™×¨×”/×˜×¢×™× ×” ×-localStorage
    â”‚   # saveState(state), loadState(): AppState | null
    â”‚
    â””â”€â”€ userStore.svelte.ts
        # × ×™×”×•×œ ××©×ª××©×™×
        # getUsers(), addUser(), setCurrentUser()
```

---

## ğŸ“Š ×™×©×•×™×•×ª ××¨×›×–×™×•×ª - ×”×¨×—×‘×”

### AppState - ××‘× ×” ××œ×

```typescript
interface AppState {
  version: number;  // ×’×¨×¡×” × ×•×›×—×™×ª: 7
  
  // ××©×ª××©×™×
  users: UserProfile[];
  currentUserId: string | null;
  
  // ×¨×©×™××•×ª (×× ×•×¨××œ×•×ª ×œ×¤×™ userId)
  lists: { [userId: string]: List[] };
  activeListId: { [userId: string]: string };
  
  // ×ª××•× ×•×ª (Normalized!)
  images: { [imageId: string]: ImageMetadata };
  
  // ×”×’×“×¨×•×ª
  settings: {
    lastActiveTime: number;  // timestamp
  };
  
  // ×’×™×‘×•×™
  lastModified: number;  // ×œ×–×™×”×•×™ ×§×•× ×¤×œ×™×§×˜×™×
}
```

### UserProfile - ××‘× ×” ××œ×

```typescript
interface UserProfile {
  id: string;           // uuid
  name: string;         // "×ª××¨", "×™×•× ×ª×Ÿ", "××¨×™××œ"
  gender: 'boy' | 'girl'; // ×œ×¤× ×™×” ××’×“×¨×™×ª
  avatar: string;       // ×¨×§ ××–×”×”: "idb:xxx" ××• URL
  themeColor: string;   // HEX: "#FF69B4"
}
```

**×“×•×’××”:**
```typescript
const user: UserProfile = {
  id: 'user-123',
  name: '×ª××¨',
  gender: 'girl',
  avatar: 'idb:avatar-456',
  themeColor: '#FF69B4'
};
```

### List - ××‘× ×” ××œ×

```typescript
interface List {
  id: string;
  name: string;           // "×©×’×¨×ª ×‘×•×§×¨", "××—×¨×™ ×”×¦×”×¨×™×™×"
  tasks: Task[];
  isDefault?: boolean;    // ×¨×©×™××ª ×‘×¨×™×¨×ª ××—×“×œ (×œ× ×œ××—×™×§×”)
  logo?: string;          // ×¨×§ ××–×”×”: "idb:xxx" ××• URL
  greeting?: string;      // "×‘×•×§×¨ ×˜×•×‘", "×‘×”×¦×œ×—×”"
  isHidden?: boolean;     // ×œ× ××•×¦×’ ×‘-ListSwitcher
}
```

**×“×•×’××”:**
```typescript
const list: List = {
  id: 'list-morning',
  name: '×©×’×¨×ª ×‘×•×§×¨',
  logo: 'idb:logo-789',
  greeting: '×‘×•×§×¨ ×˜×•×‘',
  isDefault: true,
  tasks: [
    {
      id: 'task-1',
      name: '×¦×—×¦×•×— ×©×™× ×™×™×',
      imageSrc: 'idb:img-001',
      isDone: false
    }
  ]
};
```

### Task - ××‘× ×” ××œ×

```typescript
interface Task {
  id: string;
  name: string;                      // "×¦×—×¦×•×— ×©×™× ×™×™×"
  imageSrc: string | null;           // "idb:xxx" ××• URL ××• null
  isDone: boolean;
  communicationBoardUrl?: string;    // URL ×œ×œ×•×— ×ª×§×©×•×¨×ª (Cboard)
  changeType?: 'cancelled' | 'added'; // ××©×™××ª ×©×™× ×•×™
}
```

**×“×•×’×××•×ª:**

```typescript
// ××©×™××” ×¨×’×™×œ×”
const regularTask: Task = {
  id: 'task-1',
  name: '×¦×—×¦×•×— ×©×™× ×™×™×',
  imageSrc: 'idb:img-001',
  isDone: false,
  communicationBoardUrl: 'https://app.cboard.io/...'
};

// ××©×™××” ××‘×•×˜×œ×”
const cancelledTask: Task = {
  id: 'task-2',
  name: '×”×œ×™×›×” ×œ×—×•×’',
  imageSrc: 'idb:img-002',
  isDone: false,
  changeType: 'cancelled'  // ğŸš«
};

// ××©×™××” × ×•×¡×¤×”
const addedTask: Task = {
  id: 'task-3',
  name: '×‘×™×§×•×¨ ××¦×œ ×¡×‘×ª×',
  imageSrc: 'idb:img-003',
  isDone: false,
  changeType: 'added'  // âœ¨
};
```

### ImageMetadata - ××‘× ×” ××œ×

```typescript
interface ImageMetadata {
  crop?: ImageCropData;
}

interface ImageCropData {
  x: number;      // ××™×§×•× X ×‘××—×•×–×™× (0-100)
  y: number;      // ××™×§×•× Y ×‘××—×•×–×™× (0-100)
  scale: number;  // ×–×•× **×™×—×¡×™** (1.0 = minScale, 2.0 = ×¤×™ 2 ×-minScale)
}
```

**×—×©×•×‘:** Scale ×”×•× **×™×—×¡×™**, ×œ× ××•×—×œ×˜!

```typescript
// ×“×•×’××”: ×ª××•× ×” ×¢× crop
AppState.images['idb:img-001'] = {
  crop: {
    x: 30,      // 30% ××™××™×Ÿ
    y: 20,      // 20% ××œ××¢×œ×”
    scale: 1.4  // ×¤×™ 1.4 ××”-minScale (×œ× 1.4 ××•×—×œ×˜!)
  }
};

// ×“×•×’××”: ×ª××•× ×” ×œ×œ× crop
AppState.images['idb:img-002'] = {
  crop: undefined  // ××• ×œ× ×§×™×™× ×‘×›×œ×œ
};
```

---

## ğŸ”§ ×× ×’× ×•× ×™× ××™×•×—×“×™× - ×¤×¨×˜×™× ×˜×›× ×™×™×

### 1. Normalized Data Structure

#### ×œ××” Normalized?

×‘××§×•×:
```typescript
// âŒ ×œ× ×™×¢×™×œ - ×›×¤×™×œ×•×™×•×ª
interface Task {
  imageSrc: {
    src: string;
    crop: { x: number; y: number; scale: number };
  };
}

// ××•×ª×” ×ª××•× ×” ×‘×©× ×™ tasks â†’ ×©× ×™ ×¢×•×ª×§×™× ×©×œ crop!
```

×¢×•×©×™×:
```typescript
// âœ… ×™×¢×™×œ - ××§×•×¨ ×××ª ×™×—×™×“
interface Task {
  imageSrc: string; // ×¨×§ ××–×”×”: "idb:abc123"
}

// ××˜××“×˜×” ×‘××§×•× ××—×“
AppState.images["idb:abc123"] = {
  crop: { x: 50, y: 50, scale: 1.2 }
};
```

#### ××™×š ××©×ª××©×™×?

```typescript
// ×©××™×¨×ª crop
function saveTaskImage(taskId: string, imageId: string, crop: ImageCropData) {
  // 1. ×©××•×¨ ××ª ×”××–×”×” ×‘-Task
  task.imageSrc = imageId;
  
  // 2. ×©××•×¨ ××ª ×”-crop ×‘-images
  imageStore.setImageCrop(imageId, crop);
}

// ×˜×¢×™× ×ª crop
function getTaskImageCrop(task: Task): ImageCropData | undefined {
  if (!task.imageSrc) return undefined;
  return imageStore.getImageMetadata(task.imageSrc)?.crop;
}
```

#### ×™×ª×¨×•× ×•×ª

1. **×”×¤×—×ª×ª ×›×¤×™×œ×•×™×•×ª**: ××•×ª×” ×ª××•× ×” ×‘×›××” ××©×™××•×ª â†’ metadata ××—×“
2. **× ×™×”×•×œ ×§×œ**: ×©×™× ×•×™ crop ×‘××§×•× ××—×“ ××©×¤×™×¢ ×¢×œ ×›×•×œ×
3. **×’××™×©×•×ª**: ×§×œ ×œ×”×•×¡×™×£ ×©×“×•×ª (filter, brightness)
4. **×’×™×‘×•×™**: ×§×œ ×œ-Hydrate/Dehydrate

---

## ğŸ–¼ï¸ ××¢×¨×›×ª ×—×™×ª×•×š ×ª××•× ×•×ª - ××“×¨×™×š ××œ×

### ××¨×›×™×˜×§×˜×•×¨×”

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ImageUploader.svelte                   â”‚
â”‚  - ×”×¢×œ××ª ×§×•×‘×¥                           â”‚
â”‚  - ×¤×ª×™×—×ª ImageCropEditor                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ImageCropEditor.svelte                 â”‚
â”‚  - ×¢×¨×™×›×” ××™× ×˜×¨××§×˜×™×‘×™×ª                  â”‚
â”‚  - Drag, Zoom, Reset                    â”‚
â”‚  - Scale ×™×—×¡×™ (1.0 = minScale)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  imageStore.setImageCrop(id, crop)      â”‚
â”‚  - ×©××™×¨×” ×‘-AppState.images              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ImageDisplay.svelte                    â”‚
â”‚  - ×ª×¦×•×’×” ××—×™×“×” (100% Ã— 100%)            â”‚
â”‚  - ×˜×¢×™× ×” ×-IndexedDB                    â”‚
â”‚  - ×”×—×œ×ª crop                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Scale ×™×—×¡×™ - ×”×¡×‘×¨ ××¢××™×§

#### ×”×‘×¢×™×”

×× `scale` ××•×—×œ×˜:
```typescript
crop = { x: 50, y: 50, scale: 0.333 }; // scale ××•×—×œ×˜
```

×”×‘×¢×™×”: ×‘×§×•× ×˜×™×™× ×¨ 120px, `scale: 0.333` ×¢×•×‘×“ ××¦×•×™×Ÿ.
××‘×œ ×‘×§×•× ×˜×™×™× ×¨ 400px, ××•×ª×” ×ª××•× ×” × ×¨××™×ª ×©×•× ×” ×œ×’××¨×™!

#### ×”×¤×ª×¨×•×Ÿ

`scale` **×™×—×¡×™** ×œ-minScale:
```typescript
crop = { x: 50, y: 50, scale: 1.4 }; // scale ×™×—×¡×™
```

×›×œ×•××¨: `actualScale = minScale * crop.scale`

**minScale** = ×”×–×•× ×”××™× ×™××œ×™ ×©×××œ× ××ª ×”×§×•× ×˜×™×™× ×¨.

#### ×“×•×’××” ××œ××”

```typescript
// ×ª××•× ×”: 1200px Ã— 800px
// ×§×•× ×˜×™×™× ×¨: 400px Ã— 400px (×¨×™×‘×•×¢)

// ×—×™×©×•×‘ minScale
const minScale = Math.max(
  400 / 1200,  // 0.333
  400 / 800    // 0.5
);
// minScale = 0.5 (×”×¦×“ ×”×¨×—×‘ ×§×•×‘×¢)

// ×”××©×ª××© ×‘×—×¨: scale = 1.4 (×¤×™ 1.4 ×-minScale)
const actualScale = 0.5 * 1.4 = 0.7;

// ×”×ª××•× ×” ××•×¦×’×ª ×‘-scale: 0.7
// â†’ ×¨×•×—×‘: 1200 * 0.7 = 840px
// â†’ ×’×•×‘×”: 800 * 0.7 = 560px
```

**×ª×•×¦××”:** ××•×ª×• `crop.scale = 1.4` × ×¨××” ×–×”×” ×‘×§×•× ×˜×™×™× ×¨ 120px ×•-400px!

### ImageDisplay - ×©×™××•×©

**×›×œ×œ:** ×›×œ ×ª××•× ×” ×—×™×™×‘×ª ×“×¨×š `ImageDisplay`!

```svelte
<script>
  import ImageDisplay from '$lib/components/ImageDisplay.svelte';
</script>

<!-- Parent ×§×•×‘×¢ ×’×•×“×œ -->
<div style="width: 120px; height: 120px;">
  <ImageDisplay
    imageSrc={task.imageSrc}
    alt={task.name}
    extraClasses="task-image"
    lazyLoad={true}
  />
</div>
```

**Props:**
- `imageSrc`: string (××–×”×”: "idb:xxx" ××• URL)
- `alt`: string (×ª×™××•×¨)
- `extraClasses?`: string (××—×œ×§×•×ª CSS × ×•×¡×¤×•×ª)
- `lazyLoad?`: boolean (lazy loading)

**××” ImageDisplay ×¢×•×©×”:**
1. ×˜×¢×™× ×” ×-IndexedDB (×× `idb:`)
2. ×§×‘×œ×ª crop ×-imageStore
3. ×—×™×©×•×‘ minScale
4. ×”×—×œ×ª crop (transform CSS)
5. Fallback ×¢×œ ×©×’×™××”

---

## ğŸ”Š ××¢×¨×›×ª ××•×“×™×• - ××“×¨×™×š ××œ×

### Hybrid Audio System

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  audioSequencer.playSequence()    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â†“
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â†“                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  MP3    â”‚         â”‚  TTS    â”‚
â”‚  File   â”‚         â”‚  Voice  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### AudioSegment Types

```typescript
type AudioSegment =
  | { type: 'file'; content: string }    // "/sounds/praise.mp3"
  | { type: 'tts'; content: string };    // "×¢×›×©×™×•, ×¦×—×¦×•×— ×©×™× ×™×™×"
```

### ×¨×¦×£ ××©×•×‘ ××œ× - ×“×•×’××”

```typescript
// TasksBoardController.toggleTask()

async function playCompletionFeedback(
  task: Task,
  nextTask: Task | null,
  gender: 'boy' | 'girl'
) {
  const segments: AudioSegment[] = [
    // 1. "×¡×™×™××ª ××ª..."
    { type: 'file', content: '/sounds/sequences/finished.mp3' },
    { type: 'tts', content: task.name },
    
    // 2. ×—×™×–×•×§ ×¨× ×“×•××œ×™
    ...await LanguageService.getFeedbackSequence(gender),
    
    // 3. ×”××©×™××” ×”×‘××”
    { type: 'file', content: '/sounds/sequences/now.mp3' },
    { type: 'tts', content: nextTask ? nextTask.name : '×¡×™×™××ª ×”×›×œ!' }
  ];
  
  await audioSequencer.playSequence(segments);
}
```

### boosts.ts - ×—×™×–×•×§×™× ×¨× ×“×•××œ×™×™×

```typescript
import { BOOSTS_BOY, BOOSTS_GIRL, BOOSTS_FILES } from '$lib/data/boosts';

// ×‘×—×™×¨×ª ×—×™×–×•×§ ×¨× ×“×•××œ×™
export function getRandomBoost(gender: 'boy' | 'girl'): Boost {
  const boosts = gender === 'boy' ? BOOSTS_BOY : BOOSTS_GIRL;
  const randomIndex = Math.floor(Math.random() * boosts.length);
  return boosts[randomIndex];
}

// ×™×¦×™×¨×ª ×¨×¦×£ ××©×•×‘
export async function getFeedbackSequence(gender: 'boy' | 'girl'): Promise<AudioSegment[]> {
  const boost = getRandomBoost(gender);
  const audioFile = BOOSTS_FILES[boost.audioKey];
  
  if (audioFile) {
    // MP3 preferred
    return [{ type: 'file', content: audioFile }];
  } else {
    // TTS fallback
    return [{ type: 'tts', content: boost.text }];
  }
}
```

### ××‘× ×” ×ª×™×§×™×™×ª ××•×“×™×•

```
static/sounds/
â”œâ”€â”€ ui/
â”‚   â”œâ”€â”€ ding.mp3
â”‚   â”œâ”€â”€ click.mp3
â”‚   â””â”€â”€ error.mp3
â”‚
â”œâ”€â”€ sequences/
â”‚   â”œâ”€â”€ finished.mp3        # "×¡×™×™××ª ××ª..."
â”‚   â”œâ”€â”€ now.mp3             # "×¢×›×©×™×•..."
â”‚   â”œâ”€â”€ great_job.mp3       # "×¢×‘×•×“×” ××¢×•×œ×”!"
â”‚   â””â”€â”€ change.mp3          # "×©×™× ×•×™! ×”×™×•×..."
â”‚
â””â”€â”€ boosts/
    â”œâ”€â”€ praise_aluf_boy.mp3     # "××ª×” ××œ×•×£!"
    â”œâ”€â”€ praise_alufa_girl.mp3   # "××ª ××œ×•×¤×”!"
    â”œâ”€â”€ excellent_boy.mp3       # "××¦×•×™×Ÿ!"
    â”œâ”€â”€ excellent_girl.mp3      # "××¦×•×™×Ÿ!"
    â”œâ”€â”€ well_done_boy.mp3       # "×›×œ ×”×›×‘×•×“!"
    â”œâ”€â”€ well_done_girl.mp3      # "×›×œ ×”×›×‘×•×“!"
    â””â”€â”€ ...
```

### ×œ××” ×¨× ×“×•××œ×™?

**××§×•×œ×œ×™×” (Echolalia)** - ×‘×¢×™×” × ×¤×•×¦×” ×‘××•×˜×™×–×:
- ×”×™×œ×“ ×©×•××¢ "××ª×” ××œ×•×£!" â†’ ××ª×—×™×œ ×œ×—×–×•×¨ ×¢×œ ×–×” ×›×œ ×”×–××Ÿ
- × ×›× ×¡ ×œ-"×œ×•×¤" ×©×œ ×‘×§×©×” ×œ×©××•×¢ ××ª ××•×ª×• ×¦×œ×™×œ ×©×•×‘ ×•×©×•×‘
- ××©×‘×© ××ª ×”×ª×¤×§×•×“

**×¤×ª×¨×•×Ÿ:** ××©×•×‘ ×¨× ×“×•××œ×™
- ×›×œ ×¤×¢× ×—×™×–×•×§ ×©×•× ×”
- ××•× ×¢ ×§×™×‘×¢×•×Ÿ ×¢×œ ×¦×œ×™×œ/××©×¤×˜ ×¡×¤×¦×™×¤×™
- ×¢×“×™×™×Ÿ ×—×™×•×‘×™ ×•××¢×¦×™×

---

## ğŸ—‚ï¸ ××™×’×¨×¦×™×•×ª - ××“×¨×™×š ××œ×

### ×ª×”×œ×™×š ××™×’×¨×¦×™×”

```
localStorage: { version: 5 }
         â†“
   migration.ts
         â†“
  migrateV5ToV6()
         â†“
  migrateV6ToV7()
         â†“
AppState: { version: 7 }
```

### ×“×•×’××” ××œ××”: ×”×•×¡×¤×ª ×©×“×” `changeType`

#### 1. ×¢×“×›×•×Ÿ types.ts

```typescript
// ×”×•×¡×¤×ª ×©×“×” ×—×“×©
export interface Task {
  id: string;
  name: string;
  imageSrc: string | null;
  isDone: boolean;
  communicationBoardUrl?: string;
  changeType?: 'cancelled' | 'added'; // â† ×©×“×” ×—×“×©!
}
```

#### 2. ×”×•×¡×¤×ª ××™×’×¨×¦×™×”

```typescript
// src/lib/services/migration.ts

function migrateV6ToV7(state: any): AppState {
  return {
    ...state,
    version: 7,
    
    // ×”×•×¡×£ changeType ×œ×›×œ ×”××©×™××•×ª
    lists: Object.fromEntries(
      Object.entries(state.lists).map(([userId, lists]) => [
        userId,
        (lists as any[]).map((list: any) => ({
          ...list,
          tasks: list.tasks.map((task: any) => ({
            ...task,
            changeType: task.changeType || undefined // ×¢×¨×š ×‘×¨×™×¨×ª ××—×“×œ
          }))
        }))
      ])
    )
  };
}

// ×”×•×¡×£ ×œ××¤×”
const MIGRATIONS: { [version: number]: (state: any) => AppState } = {
  1: migrateV1ToV2,
  2: migrateV2ToV3,
  3: migrateV3ToV4,
  4: migrateV4ToV5,
  5: migrateV5ToV6,
  6: migrateV6ToV7, // â† ×”×•×¡×£ ×›××Ÿ!
};
```

#### 3. ×¢×“×›×•×Ÿ ×’×¨×¡×” ×‘-defaults.ts

```typescript
// src/lib/data/defaults.ts

export const INITIAL_STATE: AppState = {
  version: 7, // â† ×¢×“×›×Ÿ ×›××Ÿ!
  users: [],
  lists: {},
  // ...
};
```

#### 4. ×‘×“×™×§×”

```typescript
// ×™×¦×™×¨×ª × ×ª×•× ×™× ×™×©× ×™× ×œ×‘×“×™×§×”
const oldState = {
  version: 6,
  users: [...],
  lists: {
    'user-1': [
      {
        id: 'list-1',
        tasks: [
          { id: 'task-1', name: '××©×™××”', isDone: false }
          // ××™×Ÿ changeType!
        ]
      }
    ]
  }
};

// ×”×¨×¦×ª ××™×’×¨×¦×™×”
const newState = migrateToLatest(oldState);

// ×‘×“×™×§×”
console.log(newState.version); // 7
console.log(newState.lists['user-1'][0].tasks[0].changeType); // undefined
```

### ×›×œ×œ×™ ××™×’×¨×¦×™×•×ª

1. **×ª××™×›×” ×œ××—×•×¨ ×—×•×‘×”**: ××©×ª××©×™× ×§×™×™××™× ×œ× ×™×›×•×œ×™× ×œ××‘×“ × ×ª×•× ×™×
2. **×©×“×” ×—×“×© = optional**: ×ª××™×“ `?` ××• ×¢×¨×š ×‘×¨×™×¨×ª ××—×“×œ
3. **××¡×¤×•×¨ ×’×¨×¡××•×ª**: ×¨×¦×™×£ (6 â†’ 7 â†’ 8)
4. **×ª×™×¢×•×“**: ×ª××¨ ××” ×”×©×ª× ×” ×‘×›×œ ×’×¨×¡×”

### ×’×¨×¡××•×ª ×§×™×™××•×ª

| ×’×¨×¡×” | ×ª×™××•×¨ | ×ª××¨×™×š |
|------|-------|-------|
| 1 | ×’×¨×¡×” ×¨××©×•× ×™×ª | - |
| 2 | ×”×•×¡×¤×ª `UserProfile.gender` | - |
| 3 | ×”×•×¡×¤×ª `AppState.images` (Normalized) | - |
| 4 | ×”×•×¡×¤×ª `List.isHidden` | - |
| 5 | ×”×•×¡×¤×ª `AppState.lastModified` | - |
| 6 | ×”×•×¡×¤×ª `Task.communicationBoardUrl` | - |
| 7 | ×”×•×¡×¤×ª `Task.changeType` | 2026-01-19 |

---

## ğŸ’» ×“×•×’×××•×ª ×§×•×“ ××œ××•×ª

### ×“×•×’××” 1: Controller ×—×“×©

```typescript
// src/lib/logic/myFeatureController.svelte.ts

import { globalState } from '$lib/stores/globalState.svelte';
import { listStore } from '$lib/stores/listStore.svelte';
import type { Task } from '$lib/types';

/**
 * Controller ×œ× ×™×”×•×œ ×”×¤×™×¦'×¨ ×©×œ×™
 */
export class MyFeatureController {
  // UI State
  private _isModalOpen = $state(false);
  private _selectedTask = $state<Task | null>(null);
  
  // Getters (×œ×—×©×™×¤×” ×œ-View)
  get isModalOpen() {
    return this._isModalOpen;
  }
  
  get selectedTask() {
    return this._selectedTask;
  }
  
  // Derived state
  get currentList() {
    return listStore.getCurrentList();
  }
  
  // Actions
  openModal(task: Task) {
    this._selectedTask = task;
    this._isModalOpen = true;
  }
  
  closeModal() {
    this._isModalOpen = false;
    this._selectedTask = null;
  }
  
  async saveChanges() {
    if (!this._selectedTask) return;
    
    // ×¢×“×›×•×Ÿ ×“×¨×š listStore
    await listStore.updateTask(this._selectedTask.id, {
      name: this._selectedTask.name
    });
    
    this.closeModal();
  }
}
```

### ×“×•×’××” 2: ×©×™××•×© ×‘-Controller

```svelte
<!-- src/routes/my-feature/+page.svelte -->

<script lang="ts">
  import { MyFeatureController } from '$lib/logic/myFeatureController.svelte';
  import { TEXTS } from '$lib/services/language';
  
  const controller = new MyFeatureController();
</script>

<div class="my-feature">
  <h1>{TEXTS.MY_FEATURE_TITLE}</h1>
  
  {#each controller.currentList?.tasks || [] as task}
    <button onclick={() => controller.openModal(task)}>
      {task.name}
    </button>
  {/each}
</div>

{#if controller.isModalOpen}
  <div class="modal">
    <h2>{TEXTS.EDIT_TASK}</h2>
    
    <input
      type="text"
      bind:value={controller.selectedTask.name}
    />
    
    <button onclick={() => controller.saveChanges()}>
      {TEXTS.SAVE}
    </button>
    
    <button onclick={() => controller.closeModal()}>
      {TEXTS.CANCEL}
    </button>
  </div>
{/if}

<style>
  /* ×¢×™×¦×•×‘ RTL */
  .my-feature {
    direction: rtl;
    text-align: start;
  }
</style>
```

### ×“×•×’××” 3: ×”×•×¡×¤×ª ×˜×§×¡×˜ ×—×“×©

```typescript
// src/lib/data/texts.ts

export const TEXTS = {
  // ... ×˜×§×¡×˜×™× ×§×™×™××™×
  
  // ×”×•×¡×¤×ª ×˜×§×¡×˜×™× ×—×“×©×™×
  MY_FEATURE_TITLE: '×”×¤×™×¦'×¨ ×©×œ×™',
  EDIT_TASK: '×¢×¨×™×›×ª ××©×™××”',
  SAVE: '×©××™×¨×”',
  CANCEL: '×‘×™×˜×•×œ',
};
```

---

## ğŸš¨ ×˜×¢×•×™×•×ª × ×¤×•×¦×•×ª - ×”×¨×—×‘×”

### 1. ×œ×•×’×™×§×” ×‘-Component (××•×¨×—×‘)

```svelte
<!-- âŒ ×“×•×’××” ×œ×˜×¢×•×ª: ×œ×•×’×™×§×” ×¢×¡×§×™×ª ×‘×§×•××¤×•× × ×˜×” -->
<script lang="ts">
  import { listStore } from '$lib/stores/listStore.svelte';
  import { audioSequencer } from '$lib/services/audioSequencer';
  
  let tasks = $state([]);
  let activeIndex = $state(0);
  let showCelebration = $state(false);
  
  // ×œ×•×’×™×§×” ×¢×¡×§×™×ª ××•×¨×›×‘×ª = ×¦×¨×™×š Controller!
  function handleTaskToggle(taskId: string) {
    const task = tasks.find(t => t.id === taskId);
    if (!task) return;
    
    task.isDone = !task.isDone;
    listStore.updateTask(taskId, { isDone: task.isDone });
    
    if (task.isDone) {
      const nextTask = tasks[activeIndex + 1];
      
      if (nextTask) {
        activeIndex++;
        
        audioSequencer.playSequence([
          { type: 'tts', content: `×¡×™×™××ª ××ª ${task.name}` },
          { type: 'file', content: '/sounds/praise.mp3' },
          { type: 'tts', content: `×¢×›×©×™×•, ${nextTask.name}` }
        ]);
      } else {
        showCelebration = true;
        audioSequencer.playSequence([
          { type: 'tts', content: '×¡×™×™××ª ×”×›×œ!' },
          { type: 'file', content: '/sounds/celebration.mp3' }
        ]);
      }
    }
  }
</script>

<!-- âœ… ×”×“×¨×š ×”× ×›×•× ×” - ×œ×•×’×™×§×” ×‘-Controller -->
<script lang="ts">
  import { TasksBoardController } from '$lib/logic/tasksBoard.svelte';
  
  const controller = new TasksBoardController();
</script>

<button onclick={() => controller.toggleTask(task.id)}>
  {task.name}
</button>

<!-- âœ… ×ª×¦×•×’×” ×¤×©×•×˜×” - OK ×‘×§×•××¤×•× × ×˜×” -->
<script lang="ts">
  let items = ['×', '×‘', '×’'];
</script>

{#each items as item}
  <div class:selected={item === currentItem}>
    {item}
  </div>
{/each}
```

**×œ××” ×–×” ×¨×¢?**
- ×œ×•×’×™×§×” ×¢×¡×§×™×ª ××•×¨×›×‘×ª ×§×©×” ×œ×‘×“×™×§×”
- ×§×©×” ×œ×©×™××•×© ×—×•×–×¨
- ×§×©×” ×œ×ª×—×–×•×§×”
- ×¢×¨×‘×•×‘ ×©×œ UI State ×¢× Business Logic

**×›×œ×œ ××¦×‘×¢:**
- ×¤×—×•×ª ×-5 ×©×•×¨×•×ª ×œ×•×’×™×§×ª ×ª×¦×•×’×” â†’ OK ×‘×§×•××¤×•× × ×˜×”
- ×™×•×ª×¨ ×-5 ×©×•×¨×•×ª ××• ×œ×•×’×™×§×” ×¢×¡×§×™×ª â†’ Controller

### 2. ×©×›×¤×•×œ × ×ª×•× ×™× (××•×¨×—×‘)

```typescript
// âŒ ×“×•×’××” ×œ×˜×¢×•×ª

// src/lib/data/myActivities.ts
export const MY_ACTIVITIES = [
  { id: 'toilet', name: '×©×™×¨×•×ª×™×', image: '/images/toilet.png' },
  { id: 'shower', name: '××§×œ×—×ª', image: '/images/shower.png' },
  // ... ×¢×•×“ ×¤×¢×™×œ×•×™×•×ª
];

// src/lib/data/defaults.ts
export const ACTIVITIES = [
  { id: 'toilet', name: '×©×™×¨×•×ª×™×', image: '/images/toilet.png' },
  { id: 'shower', name: '××§×œ×—×ª', image: '/images/shower.png' },
  // ... ××•×ª×Ÿ ×¤×¢×™×œ×•×™×•×ª!
];
```

**×‘×¢×™×”:** ×©×›×¤×•×œ! ×©×™× ×•×™ ×‘××§×•× ××—×“ ×œ× ××©×¤×™×¢ ×‘××§×•× ×”×©× ×™.

```typescript
// âœ… ×”×“×¨×š ×”× ×›×•× ×”

// src/lib/data/defaults.ts (×¨×§ ×›××Ÿ!)
export const ACTIVITIES = [
  { id: 'toilet', name: '×©×™×¨×•×ª×™×', image: '/images/toilet.png' },
  { id: 'shower', name: '××§×œ×—×ª', image: '/images/shower.png' },
];

// src/lib/components/MyComponent.svelte
import { ACTIVITIES } from '$lib/data/defaults';
// ×©×™××•×© ×™×©×™×¨ ×‘-ACTIVITIES
```

### 3. ×—×™×©×•×‘ minScale ×‘-$derived (××•×¨×—×‘)

```typescript
// âŒ ×œ× ×¢×•×‘×“!
let imageRef = $state<HTMLImageElement | null>(null);
let containerRef = $state<HTMLDivElement | null>(null);

let minScale = $derived.by(() => {
  if (!imageRef || !containerRef) return 1;
  
  // naturalWidth/Height = 0 ×›×©×”×ª××•× ×” ×¢×•×“ ×œ× × ×˜×¢× ×”!
  return Math.max(
    containerRef.offsetWidth / imageRef.naturalWidth,
    containerRef.offsetHeight / imageRef.naturalHeight
  );
});
```

**×‘×¢×™×”:** `$derived` ××—×•×©×‘ ××™×“, ×œ×¤× ×™ ×˜×¢×™× ×ª ×”×ª××•× ×”. `naturalWidth = 0`!

```typescript
// âœ… ×”×“×¨×š ×”× ×›×•× ×”
let imageRef = $state<HTMLImageElement | null>(null);
let containerRef = $state<HTMLDivElement | null>(null);
let minScale = $state(1); // ×¢×¨×š ×‘×¨×™×¨×ª ××—×“×œ

function handleLoad() {
  if (!imageRef || !containerRef) return;
  
  // ×¢×›×©×™×• naturalWidth/Height ×–××™× ×™×!
  minScale = Math.max(
    containerRef.offsetWidth / imageRef.naturalWidth,
    containerRef.offsetHeight / imageRef.naturalHeight
  );
}
```

---

## â“ FAQ - ×©××œ×•×ª ×•×ª×©×•×‘×•×ª

### ×œ××” Controllers Topic-Based ×•×œ× Page-Based?

**×©××œ×”:** ×œ××” ×œ× Controller ×œ×›×œ ×“×£? × ×•×— ×™×•×ª×¨!

**×ª×©×•×‘×”:**
- ×“×£ ××—×“ ×™×›×•×œ ×œ×”×©×ª××© ×‘××¡×¤×¨ Controllers
- ×›××” ×“×¤×™× ×™×›×•×œ×™× ×œ×—×œ×•×§ Controller
- ×”×¤×¨×“×” ×œ×•×’×™×ª: ×œ×¤×™ **×ª×—×•× ××—×¨×™×•×ª**, ×œ× ×œ×¤×™ ××¡×š

**×“×•×’××”:**
- `+page.svelte` (×“×£ ×¨××©×™) ××©×ª××© ×‘:
  - `TasksBoardController` (××©×™××•×ª)
  - `ListsNavigationController` (×¨×©×™××•×ª)
- `test-board/+page.svelte` ××©×ª××© ×’× ×‘-`TasksBoardController`

×× ×”×™×” `HomePageController` â†’ ×›×¤×™×œ×•×ª ×§×•×“!

### ×œ××” Scale ×™×—×¡×™ ×•×œ× ××•×—×œ×˜?

**×©××œ×”:** ×œ××” ×œ× ×œ×©××•×¨ `scale: 0.5` (××•×—×œ×˜)?

**×ª×©×•×‘×”:**
××•×ª×• crop ×¦×¨×™×š ×œ×”×™×¨××•×ª **×–×”×”** ×‘×’×“×œ×™ ×§×•× ×˜×™×™× ×¨ ×©×•× ×™×:
- ×§×¨×˜×™×¡×™×™×” ×§×˜× ×”: 120px Ã— 120px
- ××•×“××œ: 400px Ã— 400px
- ×”×’×“×¨×•×ª: 150px Ã— 150px

×¢× scale **××•×—×œ×˜** â†’ ×›×œ ×’×•×“×œ × ×¨××” ×©×•× ×”!
×¢× scale **×™×—×¡×™** â†’ ×›×•×œ× × ×¨××™× ×–×”×™×!

### ×œ××” localStorage × ×¤×¨×“ ×œ-floatingBoardState?

**×©××œ×”:** ×œ××” ×œ× ×‘×ª×•×š AppState?

**×ª×©×•×‘×”:**
- ×–×• ×”×’×“×¨×ª **UI** (×œ× × ×ª×•× ×™ ××©×ª××©)
- ××©×•×ª×¤×ª ×œ×›×œ ×”××©×ª××©×™×
- ×œ× ×¦×¨×™×›×” ×œ×”×™×›×œ×œ ×‘×’×™×‘×•×™×™×
- ×¢×“×›×•× ×™× ×ª×›×•×¤×™× (×›×œ ×’×¨×™×¨×”) â†’ ×œ× ×œ×˜×¨×™×’×¨ auto-backup

### ××™×š ×™×•×¦×¨×™× ×ª××•× ×•×ª ×—×“×©×•×ª?

**×©××œ×”:** ××™×š ×œ×™×¦×•×¨ ×ª××•× ×•×ª ×œ×¤×¢×™×œ×•×™×•×ª?

**×ª×©×•×‘×”:**
×”×©×ª××© ×‘×¤×¨×•××¤×˜×™× ×-`docs/prompts/image-prompts.md`:

```
Create a 16:9 wide image, 3d render style, cute icon design,
clay material, soft flat lighting, solid pure white background #FFFFFF,
no shadows on background, minimalist style, high quality render,
subject: [SUBJECT_HERE]

Examples:
- "child brushing teeth with blue toothbrush"
- "child eating breakfast at table"
- "child getting dressed"
```

**×›×œ×™:** Midjourney, DALL-E, Stable Diffusion

### ××™×š ×™×•×¦×¨×™× TTS ×—×“×©×™×?

**×©××œ×”:** ××™×š ×œ×™×¦×•×¨ ×§×‘×¦×™ ××•×“×™×• ×—×“×©×™×?

**×ª×©×•×‘×”:**
×”×©×ª××© ×‘×¤×¨×•××¤×˜×™× ×-`docs/prompts/create-tts/`:

**ElevenLabs:**
- Voice: "Bella" (×™×œ×“×”), "Bill" (×™×œ×“)
- Settings: Stability 50%, Similarity 75%
- Style: Friendly, encouraging, warm

**×˜×§×¡×˜ ×œ×“×•×’××”:**
```
××ª×” ××œ×•×£!
××ª ××œ×•×¤×”!
×¢×‘×•×“×” ××¢×•×œ×”!
×›×œ ×”×›×‘×•×“!
```

---

## ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ ×”×§×©×¨ ×¤×“×’×•×’×™ ×•××©×¤×—×ª×™ ××œ×

> **×”×¢×¨×”:** ××™×Ÿ ×¦×•×¨×š ×œ×§×¨×•× ××ª ××¡××š ×”××¤×™×•×Ÿ ×”××œ× ×‘×›×œ ××©×™××”. ×”×”×§×©×¨ ×”×—×©×•×‘ ××¨×•×›×– ×›××Ÿ!

### ×”××©×¤×—×”

- **×××:** ×¨×‘×§×” (××•×‘×™×œ×” ××ª ×”×¤×¨×•×™×§×˜)
- **×™×œ×“×™×:**
  - **×ª××¨** (×‘×ª) - ××•×˜×™×–× + ×ª×¡××•× ×ª ×“××•×Ÿ
  - **×™×•× ×ª×Ÿ** (×‘×Ÿ) - ××•×˜×™×–× + ×ª×¡××•× ×ª ×“××•×Ÿ
  - **××¨×™××œ** (×‘×Ÿ) - ××•×˜×™×–× + ×ª×¡××•× ×ª ×“××•×Ÿ

### ×”×‘×¢×™×” ×”××¨×›×–×™×ª

**"×œ×•×¤×™×" ×¢× ××™×™×¤×“/×™×•×˜×™×•×‘:**
- ×”×™×œ×“×™× × ×›× ×¡×™× ×œ××¦×‘ ×©×œ ×—×–×¨×” ××•×‘×¡×¡×™×‘×™×ª
- ×™×•× ×ª×Ÿ: "×–×” ×–×”!" (×‘×§×©×” ×—×•×–×¨×ª ×œ×™×•×˜×™×•×‘)
- ×ª××¨: "×§×¤×” ×§×¨ ×©×ª×™×”" (××§×•×œ×œ×™×”)
- ××©×‘×© ××ª ×”×ª×¤×§×•×“ ×”×™×•××™×•××™

**×“×•×’×××•×ª ××”×¤×’×™×©×•×ª:**
```
×™×•× ×ª×Ÿ: "×–×” ×–×”! ×–×” ×–×”! ×–×” ×–×”!" [×‘×§×©×” ×—×•×–×¨×ª ×œ×™×•×˜×™×•×‘]
×××™×”: "×œ× ×¢×›×©×™×•, ×¢×›×©×™×• ×¡×“×¨ ×™×•×"
×™×•× ×ª×Ÿ: [××ª×¤×¨×¥, ×××©×™×š ×œ×‘×§×©]

×ª××¨: "×©×•×ª×” ××™× ×¢× ×”×œ×©×•×Ÿ, ×©×•×ª×” ××™× ×¢× ×”×œ×©×•×Ÿ..."
×××™×”: "×›×Ÿ ××•×ª×§, ×¢×›×©×™×• ×‘×•××™ × ×¢×©×” [×¤×¢×™×œ×•×ª]"
×ª××¨: [×××©×™×›×” ×œ×—×–×•×¨]
```

### ×”×¤×ª×¨×•×Ÿ

**××›×©×™×¨ ×™×™×¢×•×“×™ (Kiosk Mode):**
- ×¨×§ ××¤×œ×™×§×¦×™×™×ª ×¡×“×¨ ×™×•×
- ××™×Ÿ ×’×™×©×” ×œ×™×•×˜×™×•×‘/××¤×œ×™×§×¦×™×•×ª ××—×¨×•×ª
- ×œ× ××™×™×¤×“ ×¨×’×™×œ!

**××©×•×‘ ×¨× ×“×•××œ×™:**
- ×× ×™×¢×ª ×§×™×‘×¢×•×Ÿ ×¢×œ ×¦×œ×™×œ/××©×¤×˜ ×¡×¤×¦×™×¤×™
- ×’×™×•×•×Ÿ ×‘×—×™×–×•×§×™×
- ×›×œ ×¤×¢× ×—×™×•×‘×™, ××‘×œ ×©×•× ×”

### ×¢×§×¨×•× ×•×ª TEACCH

×”××¢×¨×›×ª ××‘×•×¡×¡×ª ×¢×œ ×’×™×©×ª TEACCH (××•×‘× ×ª ×‘××¨×¥):

1. **Physical Structure** - ××‘× ×” ×•×™×–×•××œ×™ ×‘×¨×•×¨
   - ×›×œ ××©×™××” ×‘×›×¨×˜×™×¡×™×™×” × ×¤×¨×“×ª
   - ×¡×“×¨ ××œ××¢×œ×” ×œ××˜×”
   - ××¨×•×•×—×™× ×‘×¨×•×¨×™×

2. **Predictability** - ×¡×“×¨ ×¦×¤×•×™
   - ×”×™×œ×“ ×™×•×“×¢ ××” ×”×‘×
   - ××™×Ÿ ×”×¤×ª×¢×•×ª
   - "×¢×›×©×™×•, [××©×™××” ×”×‘××”]"

3. **Visual Clarity** - ×‘×”×™×¨×•×ª ×—×–×•×ª×™×ª
   - ×ª××•× ×•×ª ×’×“×•×œ×•×ª ×•×‘×¨×•×¨×•×ª
   - ×˜×§×¡×˜ ×§×¨×™×
   - ×¦×‘×¢×™× ×¨×›×™×, ×œ× ××¡×™×—×™ ×“×¢×ª

4. **Structured Teaching** - ×”×•×¨××” ××•×‘× ×™×ª
   - "First-Then" (×§×•×“× ×–×”, ××—×¨ ×›×š ×–×”)
   - ××¢×§×‘ ×•×™×–×•××œ×™ (V)
   - ×—×’×™×’×” ×¢×œ ×”×©×œ××”

### ××©×•×‘ ×—×™×•×‘×™ ×•××™×™×“×™

**×œ××” ×—×©×•×‘:**
- ×™×œ×“×™× ×¢× ××•×˜×™×–× ×–×§×•×§×™× ×œ××©×•×‘ ××™×™×“×™
- ×—×™×–×•×§ ×—×™×•×‘×™ ××¢×•×“×“ ×¢×¦×××•×ª
- ××•× ×¢ ×ª×¡×›×•×œ

**××™×š ××™×™×©××™×:**
- ×œ×—×™×¦×” ×¢×œ ××©×™××” â†’ ××™×“ V (×¡×™××•×Ÿ)
- ××™×“ ×”×§×¨××”: "×¡×™×™××ª ××ª [××©×™××”]!"
- ××™×“ ×—×™×–×•×§: "[×¨× ×“×•××œ×™]!"
- ××™×“ ×”××©×š: "×¢×›×©×™×•, [××©×™××” ×”×‘××”]"

**×¨×¦×£ ××œ× < 5 ×©× ×™×•×ª!**

### ×¢×¦×××•×ª

**××˜×¨×”:**
- ×¦××¦×•× ×ª×œ×•×ª ×‘××‘×•×’×¨×™×
- ×”×™×œ×“ ×× ×”×œ ××ª ×¡×“×¨ ×”×™×•× ×‘×¢×¦××•
- ×”××‘×•×’×¨ ×¨×§ ××¤×§×—, ×œ× ××•×‘×™×œ

**××™×š:**
- ×××©×§ ×¤×©×•×˜ ×•×‘×¨×•×¨
- ×”×¦×œ×—×” ××™×™×“×™×ª (×—×’×™×’×”)
- ×‘× ×™×™×ª ×‘×™×˜×—×•×Ÿ ×¢×¦××™

---

## ğŸ“Š ×¡×˜×˜×™×¡×˜×™×§×•×ª

### ×’×•×“×œ ×”×¤×¨×•×™×§×˜ (× ×›×•×Ÿ ×œ-2026-01-19)

- **×¤×™×¦'×¨×™× ××™×•×©××™×:** ~25
- **×§×‘×¦×™ Svelte:** ~20
- **Services:** ~10
- **Controllers:** ~5
- **×’×¨×¡×ª × ×ª×•× ×™×:** 7

### ×–×× ×™ ×˜×¢×™× ×”

- **First Load:** ~2 ×©× ×™×•×ª (×›×•×œ×œ Splash Screen 5s)
- **Subsequent Loads:** <0.5 ×©× ×™×•×ª (localStorage cache)
- **Image Load:** <0.3 ×©× ×™×•×ª (IndexedDB)

---

## ğŸ”— ×§×™×©×•×¨×™× ×©×™××•×©×™×™×

### ×ª×™×¢×•×“ ×—×™×¦×•× ×™

- [Svelte 5 Docs](https://svelte-5-preview.vercel.app/docs)
- [SvelteKit Docs](https://kit.svelte.dev/docs)
- [Cloudflare Pages](https://developers.cloudflare.com/pages/)

### ×ª×™×¢×•×“ ×¤× ×™××™

- `README.md` - ×¡×§×™×¨×” ×›×œ×œ×™×ª
- `walkthrough.md` - ×™×•××Ÿ ×¤×™×ª×•×—
- `features-status.md` - ××¢×§×‘ ×¤×™×¦'×¨×™×
- `agent-guide.mdc` - ××“×¨×™×š ×¨××©×™ (×§×¦×¨)

---

**×¡×•×£ ×”××“×¨×™×š ×”××•×¨×—×‘** ğŸ‰

**×–×›×•×¨:** ×–×”×• ××¡××š ×¢×–×¨. ×”××¡××š ×”×¨××©×™ ×”×•× [agent-guide.mdc](agent-guide.mdc)!
