# תכנון פיצ'רים חדשים - סדר יום ויזואלי

> **תאריך:** 18/01/2026  
> **הערה:** זהו מסמך תכנון זמני מתאריך 18/01/2026.  
> לסטטוס מעודכן של הפיצ'רים, ראו [`features-status.md`](features-status.md).

---

## חלוקה לפי קהל יעד

### פיצ'רים לילד (תצוגה)

| פיצ'ר | תיאור | הערה | סטטוס |
|-------|-------|------|-------|
| כותרת + תיאור + לוגו | סקשן עליון ברשימה | אופציונלי - בעיקר להכנה לאירועים | ⏸️ מתוכנן |
| אנשי צוות | "מי יהיה איתנו היום?" | אופציונלי - ניתן להסתיר בלחיצה | ⏸️ מתוכנן |
| משימות שינוי | סימון בוטלה (🚫) / נוספה (✨) | חשוב להכנה לשינויים | ✅ **מיושם 2026-01-19** |
| לוח תקשורת | לחצן 💬 לפתיחת iframe | חלק קריטי מהפרויקט | ✅ **מיושם 2026-01-19** |
| רשימות נעולות | לתרגול/הכנה ללא חגיגות | איחוד עם מנגנון הסתרה | ⏸️ מתוכנן |

### פיצ'רים להורה/צוות (ניהול)

| פיצ'ר | תיאור | סטטוס |
|-------|-------|--------|
| גיבוי ענן ציבורי | הגדרות Google Cloud Console | ⏸️ מוכן טכנית - דורש רק שינוי הגדרות |
| העברה/שכפול לוחות | בין משתמשים | ⏸️ מתוכנן |
| ניהול מאגר אנשי צוות | הוספה/עריכה/מחיקה של אנשי צוות | ⏸️ מתוכנן |
| הגדרת קישור תקשורת | למשימה בעריכה | ✅ **מיושם 2026-01-19** |

---

## עקרונות תצוגה

1. **הכל אופציונלי** - כל סקשן (כותרת, צוות) מוצג רק אם הוגדר
2. **אפשרות הסתרה מהירה** - לחצן להסתיר/להציג סקשן אנשי צוות בלחיצה אחת
3. **כותרת לאירועים** - מיועדת בעיקר ללוחות הכנה לאירועים עתידיים, לא לשגרה יומיומית
4. **ממשק נקי** - האתגר: להוסיף פיצ'רים תוך שמירה על עיקרון ה-distraction-free

### דוגמאות שימוש

**לוח להכנה לאירוע:**

> "ביום ראשון, אנחנו נוסעים לטיול"
>
> [לוגו גדול: אוטו, מטוס]
>
> "מה עושים? קודם [משימה 1], ואחר כך [משימה 2]"

**לוח לביקור:**

> "ביום רביעי סבא וסבתא באים"
>
> "מי בא? הנה סבא, הנה סבתא"
>
> "מה עושים? [רשימת משימות]"

---

## הסתייגויות וסיכונים

### 1. משימות שינוי והקראה - סיכון לופ

**הבעיה**: קיים סיכון שהילד ייכנס ללופ (אקולליה) על המשפט "שינוי! היום אין [משימה]!".

**נקודה נגדית**: "שינוי" היא מילת מפתח חשובה. משמעותה היא בדיוק ללמד את הילד שמשהו משתנה בסדר היום. החזרה על המילה עשויה דווקא לעזור להטמיע את הקונספט.

**המלצה**: לעקוב אחרי התגובות בפועל ולהיות מוכנים לשנות אם נראה בעיה.

### 2. רנדומיזציה של משוב

**חשוב**: לוודא שגם משוב על משימות שינוי יהיה מגוון (כמו שאר המשוב במערכת) ולא יצור תבנית קבועה שעלולה ליצור לופ.

### 3. עומס ויזואלי

**האתגר**: התוכנית מוסיפה הרבה אלמנטים למסך (כותרת, תיאור, לוגו, אנשי צוות, תגי שינוי, לחצן תקשורת).

**הפתרון**: כל אלמנט הוא אופציונלי ומוצג רק אם הוגדר. בנוסף, אפשרות להסתרה מהירה של סקשנים.

---

## 1. כותרת ותיאור לרשימה + לוגו גדול

### תיאור

לכל רשימה תתווסף אפשרות להגדיר כותרת (title) ותיאור קצר (description) - שניהם אופציונליים. הלוגו של הרשימה יוצג בגדול.

### מטרה עיקרית

**הכנה לאירועים עתידיים** - לא לשימוש יומיומי רגיל.

למשל: טיול, ביקור סבא וסבתא, אירוע מיוחד.

### דוגמאות

- **כותרת**: "לוח ליום רביעי"
- **תיאור**: "כשסבא וסבתא באים לבקר"

או:

- **כותרת**: "ביום ראשון נוסעים לטיול!"
- **תיאור**: "טיול עם כל המשפחה"
- **לוגו**: תמונה של אוטו/מטוס

### מיקום בממשק

- סקשן נפרד מעל רשימת המשימות
- הלוגו יוצג בגדול בצד הטקסט
- **מוצג רק אם מוגדר** - לא מוצג אם אין כותרת/תיאור

### שינויים נדרשים

**`src/lib/types.ts`:**

```typescript
export interface List {
  // ... שדות קיימים
  title?: string;       // כותרת אופציונלית (למשל "לוח ליום רביעי")
  description?: string; // תיאור קצר אופציונלי
}
```

**`src/routes/+page.svelte`:**

- הוספת סקשן חדש `ListHeader` מעל המשימות
- הצגת: לוגו (גדול), כותרת, תיאור - רק אם קיימים

**`src/routes/settings/lists/+page.svelte`:**

- הוספת שדות title ו-description בטופס עריכת רשימה

---

## 2. אנשי צוות / בני משפחה

### תיאור

מאגר גלובלי של אנשי צוות/בני משפחה (שם + תמונה). ניתן לבחור מהמאגר אנשים שיהיו עם הילד באותו יום.

### דוגמה

"מי יהיה איתנו היום? אמא, אורה, סבא וסבתא"

### מיקום בממשק

- סקשן מתחת לסקשן הכותרת (או בצד המסך - לבחון)
- ניהול המאגר בהגדרות
- **אופציונלי לחלוטין** - מוצג רק אם הוגדרו אנשי צוות לרשימה

### הסתרה מהירה

- לחצן קטן להסתרה/הצגה של סקשן אנשי הצוות
- שימושי כשההורה רוצה להסתיר מהר (לא מוחק, רק מסתיר זמנית)
- ההגדרה יכולה להישמר ברמת הרשימה או כהעדפת צפייה

### שינויים נדרשים

**`src/lib/types.ts`:**

```typescript
// ישות חדשה - איש צוות/בן משפחה
export interface TeamMember {
  id: string;
  name: string;
  avatar: string; // מזהה תמונה (idb:xxx או URL)
}

export interface List {
  // ... שדות קיימים
  teamMemberIds?: string[]; // מזהי אנשי צוות לרשימה זו
}

export interface AppState {
  // ... שדות קיימים
  teamMembers: TeamMember[]; // מאגר גלובלי של אנשי צוות
}
```

**קבצים חדשים:**

- `src/lib/stores/teamStore.svelte.ts` - ניהול מאגר אנשי צוות
- `src/routes/settings/team/+page.svelte` - דף ניהול אנשי צוות
- `src/lib/components/TeamMembersPicker.svelte` - בחירת אנשים לרשימה
- `src/lib/components/TeamMembersDisplay.svelte` - הצגת אנשי הצוות בלוח

---

## 3. רשימות נעולות (איחוד עם מנגנון הסתרה)

### תיאור

איחוד מנגנון הרשימות המוסתרות עם רשימות נעולות:

- רשימה נעולה/מוסתרת לא מופיעה ב-ListSwitcher
- ניתן לפתוח אותה דרך לחצן מיוחד (למטרת הכנה/תרגול)
- במצב נעול: לחיצה על משימה רק משמיעה את שמה (בלי popup חגיגה)

### שינויים נדרשים

**`src/lib/types.ts`:**

```typescript
export interface List {
  // ... שדות קיימים
  isHidden?: boolean;  // קיים - רשימה מוסתרת
  isLocked?: boolean;  // חדש - במצב נעול, לחיצה רק משמיעה
}
```

**`src/routes/+page.svelte`:**

- הוספת לחצן לפתיחת רשימות מוסתרות/נעולות
- כשרשימה נעולה: לחיצה על משימה -> השמעת שם בלבד

**`src/lib/logic/tasksBoard.svelte.ts`:**

- הוספת לוגיקה: אם הרשימה נעולה -> לא להציג חגיגה, רק להשמיע

---

## 4. משימות שינוי (בוטלה / נוספה)

> ✅ **מיושם 2026-01-19** - ראו [walkthrough.md](walkthrough.md#2026-01-19-0000)

### תיאור

אפשרות לסמן משימה כ"שינוי" - משימה שבוטלה או משימה חדשה שנוספה.

### סוגי שינוי

**משימה בוטלה:**

- אייקון: סימן "אין כניסה" (🚫)
- טקסט: "שינוי!" 
- הקראה בלחיצה: "שינוי! היום אין [שם המשימה]!"

**משימה נוספה:**

- אייקון: כוכב/ניצוץ (✨)
- טקסט: "פעילות חדשה"

### הערה חשובה - רנדומיזציה

יש לוודא **גיוון במשוב** גם למשימות שינוי:

- לא להשתמש תמיד באותה פורמולה קבועה
- אפשר להוסיף וריאציות: "אופס! שינוי!", "יש שינוי היום!" וכו'
- המטרה: למנוע יצירת תבנית קבועה שעלולה ליצור לופ (אקולליה)

**עם זאת**: "שינוי" היא מילת מפתח חשובה שמשמעותה ללמד שינויים בסדר היום. יש לעקוב אחרי התגובות בפועל.

### ממשק עריכה

- Toggle פשוט בעריכת המשימה
- אם מסומן כשינוי -> dropdown לבחירת סוג (בוטלה/נוספה)

### שינויים נדרשים

**`src/lib/types.ts`:**

```typescript
export type TaskChangeType = 'cancelled' | 'added' | null;

export interface Task {
  // ... שדות קיימים
  changeType?: TaskChangeType; // סוג השינוי (אם יש)
}
```

**`src/lib/components/TaskRow.svelte`:**

- הצגת אייקון שינוי (🚫 או ✨)
- הצגת תגית טקסט ("שינוי!" או "פעילות חדשה")

**`src/lib/components/AddModal.svelte`:**

- הוספת toggle "משימת שינוי"
- dropdown לבחירת סוג השינוי

**`src/lib/services/language.ts`:**

- הוספת טקסטים: "שינוי!", "פעילות חדשה", "היום אין..."
- לוגיקת הקראה למשימות שינוי

**קבצי אודיו נדרשים:**

- `change.mp3` - "שינוי!"
- `no_today.mp3` - "היום אין"
- (או TTS fallback)

---

## 5. גיבוי ענן ציבורי (Google Drive)

### מצב נוכחי

האפליקציה רשומה ב-Google Cloud Console במצב "Testing", מה שמאפשר רק למיילים שנרשמו ידנית להשתמש בה.

### מה נדרש

להעביר את האפליקציה למצב שכולם יוכלו להשתמש, גם אם יקבלו אזהרת "unverified app".

### הוראות ביצוע (Google Cloud Console)

1. **גישה לקונסול**: https://console.cloud.google.com/
2. **בחירת הפרויקט**: daily-schedule (או השם שנבחר)
3. **ניווט ל-OAuth consent screen**:
   - APIs & Services -> OAuth consent screen
4. **שינוי Publishing status**:
   - לחיצה על "PUBLISH APP"
   - אישור האזהרה שמשתמשים יראו מסך "unverified app"
5. **אופציה נוספת** (אם נדרש):
   - הוספת scopes מינימליים בלבד (`drive.file`)
   - מילוי פרטי האפליקציה (שם, לוגו, קישור לפרטיות)

### שינויים בקוד

- אין שינויים נדרשים בקוד
- אופציונלי: הוספת הודעה למשתמש שיראה אזהרה בפעם הראשונה

---

## 6. לוח תקשורת ב-iframe

> ✅ **מיושם 2026-01-19** - ראו [walkthrough.md](walkthrough.md#2026-01-19-0000)

### תיאור

אפשרות להוסיף למשימה קישור ללוח תקשורת (כמו Cboard) שייפתח ב-iframe צף.

### התנהגות

- לחצן עם אייקון דיבור (💬) יופיע במשימות שיש להן קישור
- הלחצן יופיע רק במשימות בסטטוס "עכשיו" או "הושלמו"
- לחיצה פותחת את `FloatingIframe` עם הקישור

### שינויים נדרשים

**`src/lib/types.ts`:**

```typescript
export interface Task {
  // ... שדות קיימים
  communicationBoardUrl?: string; // קישור ללוח תקשורת (אופציונלי)
}
```

**`src/lib/components/AddModal.svelte`:**

- הוספת שדה "קישור ללוח תקשורת" (אופציונלי)

**`src/lib/components/TaskRow.svelte`:**

- הצגת לחצן 💬 אם יש קישור
- הלחצן מופיע רק אם המשימה פעילה או הושלמה

**`src/routes/+page.svelte`:**

- הוספת FloatingIframe component
- ניהול state לפתיחה/סגירה

---

## 7. העברה/שכפול לוחות בין משתמשים

### תיאור

אפשרות להעביר או לשכפל רשימה ממשתמש אחד לאחר.

### אפשרויות

- **שכפול**: יוצר עותק אצל המשתמש השני, משאיר את המקור
- **העברה**: מעביר למשתמש השני, מוחק מהמקור
- המשתמש יבחר בזמן הפעולה

### מיקום בממשק

- בדף ניהול רשימות (`settings/lists`)
- כפתור חדש בכל רשימה או בתפריט פעולות

### שינויים נדרשים

**`src/lib/stores/listStore.svelte.ts`:**

```typescript
// פונקציה חדשה
copyListToUser(fromUserId: string, toUserId: string, listId: string, shouldMove: boolean): string | null
```

**`src/routes/settings/lists/+page.svelte`:**

- הוספת כפתור "העבר/שכפל למשתמש אחר"
- מודאל לבחירת משתמש יעד ופעולה (העבר/שכפל)

---

## 8. ארכיטקטורה וראוטינג (לחשיבה עתידית)

### מצב נוכחי

- כל המידע נשמר בצד הלקוח (localStorage + IndexedDB)
- אין צורך ב-SSR
- הראוטים הנוכחיים: `/`, `/login`, `/settings/*`

### נקודות לחשיבה

- **Hash routing**: כיוון שהמידע בצד לקוח, אפשר לשקול `#/user/123/list/456`
- **Deep linking**: ראוט ישיר לרשימה ספציפית של משתמש ספציפי
- **הסתרת עריכה**: הוחלט לא להעביר לראוט נפרד כדי לא לסרבל

### המלצה

לדחות את שינויי הארכיטקטורה לשלב מאוחר יותר, להתמקד בפיצ'רים.

---

## סדר עדיפויות מומלץ

1. ~~**משימות שינוי**~~ ✅ **מיושם 2026-01-19** - ראו [walkthrough.md](walkthrough.md#2026-01-19-0000)
2. **כותרת ותיאור לרשימה** - שינוי קטן, משפר את חווית השימוש
3. ~~**לוח תקשורת iframe**~~ ✅ **מיושם 2026-01-19** - ראו [walkthrough.md](walkthrough.md#2026-01-19-0000)
4. **רשימות נעולות** - שיפור מנגנון קיים
5. **אנשי צוות** - פיצ'ר חדש לגמרי, דורש עבודה
6. **העברה בין משתמשים** - נחמד אבל לא קריטי
7. **גיבוי ענן** - רק הגדרות בקונסול (הקוד כבר מיושם מלא)

---

## הערות טכניות

- **מיגרציה**: יש להוסיף גרסה חדשה ב-migration.ts לשדות החדשים
- **טקסטים**: כל הטקסטים ב-language.ts בלבד
- **Svelte 5**: שימוש ב-runes ($state, $derived) בכל הקוד החדש
- **עקרון distraction-free**: בכל פיצ'ר חדש, לבדוק שלא נוצר עומס ויזואלי מיותר
- **תיעוד**: מבוסס על מסמך "אפיון ותכנון של כלים דיגיטליים" - docs/private-docs/
